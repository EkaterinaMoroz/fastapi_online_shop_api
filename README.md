## FastApi Online Shop Endpoints

Этот проект - решение тестового задания. Требования были следующими: 

Начальные данные:
- Фреймворк Fastapi
- База данных (Любая реляционка) на выбор (использование SQLAlchemy в любом случае)
 /использовалась SQLAlchemy/

Задание:
1. Авторизация и аутентификация (Basic Auth, Digest Auth, token, session) /реализовано частично/
- Необходима возможность авторизации на сайте с дальнейшей аутентификацией запросов.
- Регистрацию пользователей можно пропустить (добавить в базу данных). 
2. Есть сущность склад.
- на нем есть некоторое кол-во единиц товара (например, яблок, чтобы задачу упростить
не будем использовать разновидность товаров)
3. Есть 2 типа людей:
- покупатели
- продавцы
4. Нужны АПИ методы
- добавить возможность добавления товара продавцом
- если добавить пытается покупатель - выбрасывать ошибку 403
- Добавить возможность покупки товара покупателем
- если обратился к методу продавец - выбрасываем ошибку 403 /не реализовано/
- если товара на складе не осталось - отдавать ошибку 404
5. Приветствуется настройка и ведение логов, использование модульного тестирования на
 pytest - Опционально. /не реализовано/

В репозитории есть 5 основных модулей:

+ routes.py 
Этот файл - входня точка приложения, содержит все роуты, которые вызывают соответстующие функции
+ crud.py
Набор функций, взаимодействующих с базой данных
+ models.py
Определение всех таблиц в базе данных
+ schema.py
Содержит схемы данных для приложения
+ database.py
Подключает базу данных


# Endpoints
Это базовое E-commerce-приложение, которое содержит в себе функции авторизации/регистрациии пользователей, функционал корзины, функционал администрирования

В приложении доступны следующие API:

+ /register
+ /login
+ /get_user/username
+ /add_item
+ /get_item/id
+ /del_item/id
+ /add_to_cart/username
+ /del_cart_item/id
+ /payment (заглушка)

## Code Samples

Пример работы эндпоинта get_item/id:

> routes.py
```
@app.get("/get_item/{id}", response_model=schemas.ItemAInfo)
def get_item(id, db: Session = Depends(get_db)):
    db_item = crud.get_item_by_id(db, id=id)
    if db_item is None:
        raise HTTPException(status_code=400, detail="No item found")
    elif db_item.itemamount < 1:
        raise HTTPException(status_code=404, detail="No item found")
    return db_item
```

Приведенный пример кода вызывает функцию <b>get_item_by_id</b> в модуле crud.py для обращения к базе данных:

<b>crud.py</b>
```
def get_item_by_id(db: Session, id: int):
    return db.query(models.ItemInfo).filter(models.ItemInfo.id == id).first()
```
Функция get_item_by_id обращается к бд DB чтобы найти товар по id, который передается в параметрах


## Install

```sh
git clone 
pip install -r requirements.txt
cd src
```

